'use strict';

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.ParsingMessageHandler = undefined;

var _getPrototypeOf = require('babel-runtime/core-js/object/get-prototype-of');

var _getPrototypeOf2 = _interopRequireDefault(_getPrototypeOf);

var _classCallCheck2 = require('babel-runtime/helpers/classCallCheck');

var _classCallCheck3 = _interopRequireDefault(_classCallCheck2);

var _createClass2 = require('babel-runtime/helpers/createClass');

var _createClass3 = _interopRequireDefault(_createClass2);

var _possibleConstructorReturn2 = require('babel-runtime/helpers/possibleConstructorReturn');

var _possibleConstructorReturn3 = _interopRequireDefault(_possibleConstructorReturn2);

var _get3 = require('babel-runtime/helpers/get');

var _get4 = _interopRequireDefault(_get3);

var _inherits2 = require('babel-runtime/helpers/inherits');

var _inherits3 = _interopRequireDefault(_inherits2);

exports.default = createParser;

var _argsParser = require('../util/args-parser');

var _delegate = require('./delegate');

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

var ParsingMessageHandler = exports.ParsingMessageHandler = function (_DelegatingMessageHan) {
  (0, _inherits3.default)(ParsingMessageHandler, _DelegatingMessageHan);

  function ParsingMessageHandler() {
    var options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};
    var children = arguments[1];
    (0, _classCallCheck3.default)(this, ParsingMessageHandler);

    var _this = (0, _possibleConstructorReturn3.default)(this, (ParsingMessageHandler.__proto__ || (0, _getPrototypeOf2.default)(ParsingMessageHandler)).call(this, options, children));

    _this.parseOptions = options.parseOptions || {};
    return _this;
  }

  // Parse arguments and options from message and pass the resulting object
  // into the specified handleMessage function.


  (0, _createClass3.default)(ParsingMessageHandler, [{
    key: 'handleMessage',
    value: function handleMessage() {
      var _get2;

      var message = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : '';

      var parsed = (0, _argsParser.parseArgs)(message, this.parseOptions);
      parsed.text = message;

      for (var _len = arguments.length, args = Array(_len > 1 ? _len - 1 : 0), _key = 1; _key < _len; _key++) {
        args[_key - 1] = arguments[_key];
      }

      return (_get2 = (0, _get4.default)(ParsingMessageHandler.prototype.__proto__ || (0, _getPrototypeOf2.default)(ParsingMessageHandler.prototype), 'handleMessage', this)).call.apply(_get2, [this, parsed].concat(args));
    }
  }]);
  return ParsingMessageHandler;
}(_delegate.DelegatingMessageHandler);

function createParser() {
  for (var _len2 = arguments.length, args = Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {
    args[_key2] = arguments[_key2];
  }

  return new (Function.prototype.bind.apply(ParsingMessageHandler, [null].concat(args)))();
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9tZXNzYWdlLWhhbmRsZXIvcGFyc2VyLmpzIl0sIm5hbWVzIjpbImNyZWF0ZVBhcnNlciIsIlBhcnNpbmdNZXNzYWdlSGFuZGxlciIsIm9wdGlvbnMiLCJjaGlsZHJlbiIsInBhcnNlT3B0aW9ucyIsIm1lc3NhZ2UiLCJwYXJzZWQiLCJ0ZXh0IiwiYXJncyJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztrQkFvQndCQSxZOztBQXBCeEI7O0FBQ0E7Ozs7SUFFYUMscUIsV0FBQUEscUI7OztBQUVYLG1DQUFvQztBQUFBLFFBQXhCQyxPQUF3Qix1RUFBZCxFQUFjO0FBQUEsUUFBVkMsUUFBVTtBQUFBOztBQUFBLG9LQUM1QkQsT0FENEIsRUFDbkJDLFFBRG1COztBQUVsQyxVQUFLQyxZQUFMLEdBQW9CRixRQUFRRSxZQUFSLElBQXdCLEVBQTVDO0FBRmtDO0FBR25DOztBQUVEO0FBQ0E7Ozs7O29DQUNxQztBQUFBOztBQUFBLFVBQXZCQyxPQUF1Qix1RUFBYixFQUFhOztBQUNuQyxVQUFNQyxTQUFTLDJCQUFVRCxPQUFWLEVBQW1CLEtBQUtELFlBQXhCLENBQWY7QUFDQUUsYUFBT0MsSUFBUCxHQUFjRixPQUFkOztBQUZtQyx3Q0FBTkcsSUFBTTtBQUFOQSxZQUFNO0FBQUE7O0FBR25DLHVNQUEyQkYsTUFBM0IsU0FBc0NFLElBQXRDO0FBQ0Q7Ozs7O0FBSVksU0FBU1IsWUFBVCxHQUErQjtBQUFBLHFDQUFOUSxJQUFNO0FBQU5BLFFBQU07QUFBQTs7QUFDNUMsNENBQVdQLHFCQUFYLGdCQUFvQ08sSUFBcEM7QUFDRCIsImZpbGUiOiJwYXJzZXIuanMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge3BhcnNlQXJnc30gZnJvbSAnLi4vdXRpbC9hcmdzLXBhcnNlcic7XG5pbXBvcnQge0RlbGVnYXRpbmdNZXNzYWdlSGFuZGxlcn0gZnJvbSAnLi9kZWxlZ2F0ZSc7XG5cbmV4cG9ydCBjbGFzcyBQYXJzaW5nTWVzc2FnZUhhbmRsZXIgZXh0ZW5kcyBEZWxlZ2F0aW5nTWVzc2FnZUhhbmRsZXIge1xuXG4gIGNvbnN0cnVjdG9yKG9wdGlvbnMgPSB7fSwgY2hpbGRyZW4pIHtcbiAgICBzdXBlcihvcHRpb25zLCBjaGlsZHJlbik7XG4gICAgdGhpcy5wYXJzZU9wdGlvbnMgPSBvcHRpb25zLnBhcnNlT3B0aW9ucyB8fCB7fTtcbiAgfVxuXG4gIC8vIFBhcnNlIGFyZ3VtZW50cyBhbmQgb3B0aW9ucyBmcm9tIG1lc3NhZ2UgYW5kIHBhc3MgdGhlIHJlc3VsdGluZyBvYmplY3RcbiAgLy8gaW50byB0aGUgc3BlY2lmaWVkIGhhbmRsZU1lc3NhZ2UgZnVuY3Rpb24uXG4gIGhhbmRsZU1lc3NhZ2UobWVzc2FnZSA9ICcnLCAuLi5hcmdzKSB7XG4gICAgY29uc3QgcGFyc2VkID0gcGFyc2VBcmdzKG1lc3NhZ2UsIHRoaXMucGFyc2VPcHRpb25zKTtcbiAgICBwYXJzZWQudGV4dCA9IG1lc3NhZ2U7XG4gICAgcmV0dXJuIHN1cGVyLmhhbmRsZU1lc3NhZ2UocGFyc2VkLCAuLi5hcmdzKTtcbiAgfVxuXG59XG5cbmV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uIGNyZWF0ZVBhcnNlciguLi5hcmdzKSB7XG4gIHJldHVybiBuZXcgUGFyc2luZ01lc3NhZ2VIYW5kbGVyKC4uLmFyZ3MpO1xufVxuIl19
